# üîç –ü–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç –æ–± –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ –æ—à–∏–±–æ–∫

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –û–®–ò–ë–ö–ò (—Ç—Ä–µ–±—É—é—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)

### 1. **üèÉ‚Äç‚ôÇÔ∏è Runtime Error: Force Unwrap –≤ ReaderViewModel**
**–§–∞–π–ª**: `android/feature-reader/src/main/java/com/example/feature/reader/ui/ReaderViewModel.kt:81`
```kotlin
// ‚ùå –ü–†–û–ë–õ–ï–ú–ê:
bookReader = readerFactory.create(uri)
val pageCount = bookReader!!.open(uri)  // ‚ö†Ô∏è Force unwrap –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏!
```
**–†–∏—Å–∫**: –ï—Å–ª–∏ `readerFactory.create()` –≤—ã–±—Ä–æ—Å–∏—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, `bookReader` –æ—Å—Ç–∞–Ω–µ—Ç—Å—è null, –Ω–æ `!!` –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è –≤—ã–∑–≤–∞—Ç—å –º–µ—Ç–æ–¥ –Ω–∞ null ‚Üí **CRASH**

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```kotlin
// ‚úÖ –ò–°–ü–†–ê–í–ò–¢–¨:
bookReader = readerFactory.create(uri)
val pageCount = bookReader?.open(uri) ?: throw IllegalStateException("Failed to create reader")
```

### 2. **üìö Missing Dependency: DJVU Library**
**–§–∞–π–ª**: `android/feature-reader/src/main/java/com/example/feature/reader/data/DjvuReader.kt`
```kotlin
// ‚ùå –ü–†–û–ë–õ–ï–ú–ê:
import com.djvu.android.DjvuContext  // –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ù–ï –≤–∫–ª—é—á–µ–Ω–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏!
```
**–†–∏—Å–∫**: `ClassNotFoundException` –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DJVU —Ñ–∞–π–ª—ã

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**:
1. –î–æ–±–∞–≤–∏—Ç—å DJVU –±–∏–±–ª–∏–æ—Ç–µ–∫—É –≤ `build.gradle.kts` –∏–ª–∏ 
2. –£–¥–∞–ª–∏—Ç—å DJVU –ø–æ–¥–¥–µ—Ä–∂–∫—É –∏–∑ `BookReaderFactory`

### 3. **üîÑ Duplicate Classes Conflict**
**–ü—Ä–æ–±–ª–µ–º–∞**: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –∏–º–µ–Ω–∞–º–∏:

#### ReaderScreen (3 —Ñ–∞–π–ª–∞):
- `android/feature-reader/src/main/java/com/example/feature/reader/ui/ReaderScreen.kt` ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- `android/app/src/main/java/com/example/mrcomic/ui/ReaderScreen.kt` ‚ùå –î—É–±–ª–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- `android/app/src/main/java/com/example/mrcomic/ui/screens/ReaderScreen.kt` ‚ùå –î—É–±–ª–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

#### ComicRepository (2 —Ñ–∞–π–ª–∞):
- `android/core-data/src/main/java/com/example/core/data/repository/ComicRepository.kt` ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- `android/app/src/main/java/com/example/mrcomic/data/ComicRepository.kt` ‚ùå –î—É–±–ª–∏—Ä—É–µ—Ç

**–†–∏—Å–∫**: –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∏–º–ø–æ—Ä—Ç–æ–≤, –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ, –ø—É—Ç–∞–Ω–∏—Ü–∞ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

---

## ‚ö†Ô∏è –°–ï–†–¨–ï–ó–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ (—Ç—Ä–µ–±—É—é—Ç –≤–Ω–∏–º–∞–Ω–∏—è)

### 4. **üì¶ Build System Issues**
- **Gradle deprecation warnings**: –ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ Gradle —Ñ—É–Ω–∫—Ü–∏–∏
- **SDK location not found**: –û–∂–∏–¥–∞–µ–º–æ –¥–ª—è —Å—Ä–µ–¥—ã –±–µ–∑ Android SDK
- **Module structure conflicts**: –ù–∞–ª–∏—á–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–æ–¥—É–ª–µ–π

### 5. **üé® Code Quality Issues**
- **Star imports**: 7 —Ñ–∞–π–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `import ....*` (–ø–ª–æ—Ö–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞)
- **Unused imports**: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ `Arrangement` –∏–º–ø–æ—Ä—Ç—ã
- **Inconsistent package structure**: –§–∞–π–ª—ã —Ä–∞–∑–±—Ä–æ—Å–∞–Ω—ã –ø–æ —Ä–∞–∑–Ω—ã–º –ø–∞–∫–µ—Ç–∞–º

---

## üêõ –ü–û–¢–ï–ù–¶–ò–ê–õ–¨–ù–´–ï –û–®–ò–ë–ö–ò (—Å—Ç–æ–∏—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å)

### 6. **üìÅ File System Access**
**–§–∞–π–ª**: `android/core-data/src/main/java/com/example/core/data/repository/ComicRepository.kt`
```kotlin
// –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ —Ñ–∞–π–ª–∞–º:
directory.listFiles()?.forEach { file ->
    // –ú–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å null –µ—Å–ª–∏ –Ω–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
}
```

### 7. **üîí Permission Handling**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è `READ_EXTERNAL_STORAGE`
- –ù–∞ Android 13+ –Ω—É–∂–Ω—ã –±–æ–ª–µ–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
- –ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–ª—É—á–∞—è –æ—Ç–∫–∞–∑–∞ –≤ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è—Ö

### 8. **üßµ Thread Safety**
- `bitmapCache` –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∏–∑ —Ä–∞–∑–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤
- `bookReader` –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è –±–µ–∑ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- StateFlow updates –º–æ–≥—É—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å

---

## üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ü–†–û–ë–õ–ï–ú

### –ü–æ –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏:
- üö® **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï**: 3 –ø—Ä–æ–±–ª–µ–º—ã (–º–æ–≥—É—Ç –≤—ã–∑–≤–∞—Ç—å –∫—Ä–∞—à–∏)
- ‚ö†Ô∏è **–°–ï–†–¨–ï–ó–ù–´–ï**: 2 –ø—Ä–æ–±–ª–µ–º—ã (–≤–ª–∏—è—é—Ç –Ω–∞ —Å–±–æ—Ä–∫—É)
- üêõ **–ü–û–¢–ï–ù–¶–ò–ê–õ–¨–ù–´–ï**: 3 –ø—Ä–æ–±–ª–µ–º—ã (–º–æ–≥—É—Ç –≤—ã–∑–≤–∞—Ç—å –±–∞–≥–∏)

### –ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:
- **Runtime Safety**: 1 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞
- **Dependencies**: 1 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞  
- **Architecture**: 1 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ + 2 —Å–µ—Ä—å–µ–∑–Ω—ã–µ
- **Code Quality**: 2 —Å–µ—Ä—å–µ–∑–Ω—ã–µ + 3 –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ

---

## üõ†Ô∏è –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã)

### ‚ö° –ù–ï–ú–ï–î–õ–ï–ù–ù–û (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ):
1. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å force unwrap** –≤ ReaderViewModel
2. **–£–¥–∞–ª–∏—Ç—å DJVU –ø–æ–¥–¥–µ—Ä–∂–∫—É** –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É
3. **–£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã** (–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –≤ feature –º–æ–¥—É–ª—è—Ö)

### üîß –í –ë–õ–ò–ñ–ê–ô–®–ï–ï –í–†–ï–ú–Ø (—Å–µ—Ä—å–µ–∑–Ω—ã–µ):
4. **–û—á–∏—Å—Ç–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã**
5. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å deprecated Gradle —Ñ—É–Ω–∫—Ü–∏–∏**
6. **–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–∫–µ—Ç–æ–≤**

### üìù –ü–û –í–û–ó–ú–û–ñ–ù–û–°–¢–ò (–ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ):
7. **–î–æ–±–∞–≤–∏—Ç—å null-checks** –¥–ª—è file operations
8. **–£–ª—É—á—à–∏—Ç—å permission handling** –¥–ª—è Android 13+
9. **–î–æ–±–∞–≤–∏—Ç—å thread safety** –¥–ª—è shared resources

---

## üß™ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ

### –¢–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫:
1. **Unit test**: ReaderViewModel —Å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ URI
2. **Integration test**: –ü–æ–ø—ã—Ç–∫–∞ –æ—Ç–∫—Ä—ã—Ç—å DJVU —Ñ–∞–π–ª
3. **UI test**: –ù–∞–≤–∏–≥–∞—Ü–∏—è –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ ReaderScreen

### –¢–µ—Å—Ç—ã –¥–ª—è edge cases:
1. **–§–∞–π–ª—ã –±–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –Ω–∞ —á—Ç–µ–Ω–∏–µ**
2. **–ü–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–µ –∞—Ä—Ö–∏–≤—ã CBZ/CBR**
3. **–û—á–µ–Ω—å –±–æ–ª—å—à–∏–µ PDF —Ñ–∞–π–ª—ã**
4. **–û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤**

---

## üìà –ú–ï–¢–†–ò–ö–ò –ü–û–°–õ–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### –û–∂–∏–¥–∞–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
- ‚úÖ **0 runtime crashes** –æ—Ç force unwrap
- ‚úÖ **0 ClassNotFoundException** –æ—Ç missing dependencies  
- ‚úÖ **–ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- ‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞** –±–µ–∑ warnings
- ‚úÖ **–£–ª—É—á—à–µ–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** –æ—Ç optimized imports

**üéØ –¶–µ–ª—å: –î–æ—Å—Ç–∏—á—å —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ, crash-free –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å —á–∏—Å—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π**